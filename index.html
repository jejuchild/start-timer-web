<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SNUPOOL 스타트 타이머</title>
  <style>
    body { margin: 0; font-family: -apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background: #fff; color: #0b0b0b; text-align: center; display: flex; flex-direction: column; min-height: 100vh; }
    header { padding: 0; }
    header img { max-width: 288px; height: auto; display:block; margin:0 auto; }
    .wrap { flex: 1; display: grid; place-items: center; padding: 0 24px 24px; }
    .panel { display: grid; gap: 28px; justify-items: center; grid-template-columns: 1fr auto; align-items: start; }
    #timer {
      font-variant-numeric: tabular-nums; 
      font-size: clamp(40px, 8vw, 88px);
      font-weight: 800;
      letter-spacing: 0.02em;
      padding: 16px 24px;
      border-radius: 16px;
      background: #e9ecef;
      min-width: 480px;
      text-align: center;
      margin-top: -8px; /* 로고와의 공간을 더 줄이기 위해 살짝 위로 올림 */
    }
    @media (max-width: 720px) {
      .panel { grid-template-columns: 1fr; }
      #timer { min-width: auto; width: 100%; }
    }
    .controls { display: grid; grid-auto-flow: column; gap: 12px; }
    button {
      appearance: none; border: 0; cursor: pointer;
      background: #f3f4f6; color: #0b0b0b;
      padding: 14px 20px; border-radius: 12px;
      font-size: 18px; font-weight: 700;
      box-shadow: 0 1px 2px rgba(0,0,0,0.06), 0 1px 1px rgba(0,0,0,0.04);
      transition: transform .04s ease, background .15s ease;
    }
    button:hover { background: #e5e7eb; }
    button:active { transform: translateY(1px) scale(0.997); }
    .laps { background:#f9fafb; border:1px solid #e5e7eb; border-radius:12px; padding:12px; min-width:180px; text-align:left; }
    .laps h3 { margin:0 0 8px; font-size:16px; }
    .laps ul { list-style:none; padding:0; margin:0; font-size:14px; }
    .laps li { padding:2px 0; border-bottom:1px solid #e5e7eb; }
    .laps li:last-child { border-bottom:none; }
    footer { padding: 16px; font-size: 14px; color: #374151; }
    #lang-warning { margin-top: 8px; font-size: 14px; color: red; display: none; }
  </style>
</head>
<body>
  <header>
    <img src="KakaoTalk_Photo_2025-08-17-18-57-07.jpeg" alt="SNUPOOL 로고" />
  </header>

  <main class="wrap">
    <section class="panel" aria-labelledby="h1">
      <h1 id="h1" class="sr-only">스타트 타이머</h1>
      <div>
        <div id="timer">00:00:00.00</div>
        <div class="controls">
          <button id="btn-ready" type="button">준비</button>
          <button id="btn-start" type="button">출발</button>
          <button id="btn-stop"  type="button">중지</button>
          <button id="btn-lap"   type="button">랩</button>
          <button id="btn-reset" type="button">리셋</button>
        </div>
      </div>
      <aside class="laps">
        <h3>기록</h3>
        <ul id="lap-list"></ul>
      </aside>
    </section>
  </main>

  <footer>
    <p>단축키: Space = 시작/중지 · R = 리셋 · L = 랩</p>
    <p id="lang-warning">한글로 설정되어있습니다! 한/영키 눌러주세요!</p>
  </footer>

  <audio id="audio-ready" preload="auto">
    <source src="takeyourmarks.mp3" type="audio/mpeg" />
    <source src="takeyourmarks.wav" type="audio/wav" />
  </audio>
  <audio id="audio-beep" preload="auto">
    <source src="beep.mp3" type="audio/mpeg" />
    <source src="beep.wav" type="audio/wav" />
  </audio>

  <script>
  (() => {
    const timerEl = document.getElementById('timer');
    const aReady = document.getElementById('audio-ready');
    const aBeep  = document.getElementById('audio-beep');
    const lapList = document.getElementById('lap-list');
    const warningEl = document.getElementById('lang-warning');
    const $ = (id) => document.getElementById(id);
    const btnReady = $('btn-ready');
    const btnStart = $('btn-start');
    const btnStop  = $('btn-stop');
    const btnLap   = $('btn-lap');
    const btnReset = $('btn-reset');

    let running = false;
    let startTs = 0;
    let accMs   = 0;
    let rafId   = null;

    const pad = (n, w = 2) => String(n).padStart(w, '0');
    function format(ms) {
      const cs = Math.floor(ms / 10);
      const hrs  = Math.floor(cs / 360000);
      const mins = Math.floor((cs / 6000) % 60);
      const secs = Math.floor((cs / 100) % 60);
      const c    = cs % 100;
      return `${pad(hrs)}:${pad(mins)}:${pad(secs)}.${pad(c)}`;
    }

    function tick() {
      if (!running) return;
      const now = performance.now();
      const ms = accMs + (now - startTs);
      timerEl.textContent = format(ms);
      rafId = requestAnimationFrame(tick);
    }

    function start() {
      if (running) return;
      running = true;
      startTs = performance.now();
      tick();
    }

    function stop() {
      if (!running) return;
      running = false;
      cancelAnimationFrame(rafId);
      accMs += performance.now() - startTs;
    }

    function reset() {
      running = false;
      cancelAnimationFrame(rafId);
      startTs = 0;
      accMs = 0;
      timerEl.textContent = '00:00:00.00';
      lapList.innerHTML = '';
    }

    function lap() {
      const now = running ? accMs + (performance.now() - startTs) : accMs;
      const li = document.createElement('li');
      li.textContent = format(now);
      lapList.appendChild(li);
    }

    async function play(audioEl) {
      try {
        audioEl.currentTime = 0;
        await audioEl.play();
      } catch (err) {
        console.error('오디오 재생 실패:', err);
        alert('오디오를 재생할 수 없습니다. 브라우저 권한/볼륨/포맷을 확인하세요.');
      }
    }

    btnReady.addEventListener('click', () => play(aReady));
    btnStart.addEventListener('click', async () => { await play(aBeep); start(); });
    btnStop.addEventListener('click', stop);
    btnLap.addEventListener('click', lap);
    btnReset.addEventListener('click', reset);

    // 버튼 클릭 시에는 한/영 경고를 건드리지 않음 (감지 끔)
    document.querySelectorAll("button").forEach(btn=>{
      btn.addEventListener("click", ()=>{ warningEl.style.display = 'none'; });
    });

    window.addEventListener('keydown', (e) => {
      if (e.target && (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA')) return;
      if (e.code === 'Space') { e.preventDefault(); running ? stop() : start(); }
      else if (e.key && e.key.toLowerCase() === 'r') { reset(); }
      else if (e.key && e.key.toLowerCase() === 'l') { lap(); }
      else if (/[^a-zA-Z0-9]/.test(e.key)) {
        warningEl.style.display = 'block';
        return;
      }
      warningEl.style.display = 'none';
    });
  })();
  </script>
</body>
</html>
